<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Alert Name: SOC168 – Whoami Command Detected in Request Body
Severity: High
Event ID: 118
Event Time: Feb 28, 2022, 04:12 AM
Category: Web Attack
Play Book 1. Alert Overview A high-severity web attack alert was triggered on WebServer1004 due to the detection of the whoami command within the HTTP request body. This behavior is commonly associated with command injection attempts, where an attacker tries to execute system-level commands through a web application." />
<meta name="keywords" content=", letsdefend, soc, blue, web-attack, command-injection, http" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/writeups/letsdefend/alerts/soc168---whoami-command-detected-in-request-body/" />


    <title>
        
            LetsDefend SOC168 – Command Injection (whoami) Web Attack Analysis :: Hello w3nch 
        
    </title>





  <link rel="stylesheet" href="/main.min.ebe3824dfa5345ef854f8b255c278f701966e9be3892354b588fb1650ecd358e.css" integrity="sha256-6&#43;OCTfpTRe&#43;FT4slXCePcBlm6b44kjVLWI&#43;xZQ7NNY4=" crossorigin="anonymous">




    
        <link rel="stylesheet" type="text/css" href="css/code.css">
    

    
        <link rel="stylesheet" type="text/css" href="css/writeups.css">
    


    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="LetsDefend SOC168 – Command Injection (whoami) Web Attack Analysis">
<meta itemprop="description" content="Alert Name: SOC168 – Whoami Command Detected in Request Body
Severity: High
Event ID: 118
Event Time: Feb 28, 2022, 04:12 AM
Category: Web Attack
Play Book 1. Alert Overview A high-severity web attack alert was triggered on WebServer1004 due to the detection of the whoami command within the HTTP request body. This behavior is commonly associated with command injection attempts, where an attacker tries to execute system-level commands through a web application."><meta itemprop="datePublished" content="2026-01-13T00:00:00+00:00" />
<meta itemprop="dateModified" content="2026-01-13T00:00:00+00:00" />
<meta itemprop="wordCount" content="547">
<meta itemprop="keywords" content="letsdefend,soc,blue,web-attack,command-injection,http," />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="LetsDefend SOC168 – Command Injection (whoami) Web Attack Analysis"/>
<meta name="twitter:description" content="Alert Name: SOC168 – Whoami Command Detected in Request Body
Severity: High
Event ID: 118
Event Time: Feb 28, 2022, 04:12 AM
Category: Web Attack
Play Book 1. Alert Overview A high-severity web attack alert was triggered on WebServer1004 due to the detection of the whoami command within the HTTP request body. This behavior is commonly associated with command injection attempts, where an attacker tries to execute system-level commands through a web application."/>





    <meta property="article:section" content="SOC Writeups" />

    <meta property="article:section" content="Web Security" />



    <meta property="article:published_time" content="2026-01-13 00:00:00 &#43;0000 UTC" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                hello ;)</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner">
                <li><a href="/about/">About</a></li>
            
                <li><a href="/posts/">Blog</a></li>
            
                <li><a href="/contact/">Contact</a></li>
            
                <li><a href="/resume.pdf">Resume</a></li>
            
                <li><a href="/writeups/">Writeups</a></li>
            
    </ul>
</nav>


                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            
    <div class="content">
        <main class="post">

            <div class="post-info">
                
                </p>
            </div>

            <article>
                <h2 class="post-title"><a href="http://localhost:1313/writeups/letsdefend/alerts/soc168---whoami-command-detected-in-request-body/">LetsDefend SOC168 – Command Injection (whoami) Web Attack Analysis</a></h2>

                
                
                

                <div class="post-content">
                    <p><strong>Alert Name:</strong> SOC168 – Whoami Command Detected in Request Body<br>
<strong>Severity:</strong> High<br>
<strong>Event ID:</strong> 118<br>
<strong>Event Time:</strong> Feb 28, 2022, 04:12 AM<br>
<strong>Category:</strong> Web Attack</p>
<h2 id="play-book">Play Book</h2>
<h3 id="1-alert-overview">1. Alert Overview</h3>
<p>A high-severity web attack alert was triggered on <strong>WebServer1004</strong> due to the detection of the <code>whoami</code> command within the HTTP request body. This behavior is commonly associated with <strong>command injection attempts</strong>, where an attacker tries to execute system-level commands through a web application.</p>
<p>The request originated from an external IP address and was allowed by the device, which increases the risk level of this incident.</p>
<h3 id="2-key-event-details">2. Key Event Details</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hostname</td>
<td>WebServer1004</td>
</tr>
<tr>
<td>Destination IP</td>
<td>172.16.17.16</td>
</tr>
<tr>
<td>Source IP</td>
<td>61.177.172.87</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Requested URL</td>
<td><a href="https://172.16.17.16/video/">https://172.16.17.16/video/</a></td>
</tr>
<tr>
<td>User-Agent</td>
<td>Mozilla/4.0 (MSIE 6.0; Windows NT 5.1)</td>
</tr>
<tr>
<td>Trigger Reason</td>
<td>Request body contains <code>whoami</code> string</td>
</tr>
<tr>
<td>Device Action</td>
<td>Allowed</td>
</tr>
</tbody>
</table>
<h3 id="3-why-this-alert-was-triggered">3. Why This Alert Was Triggered</h3>
<p>The detection rule is designed to identify OS command execution patterns inside HTTP request bodies. The <code>whoami</code> command is frequently used by attackers to verify successful command execution and identify the privilege level of the exploited process.</p>
<p>Based on the rule name and request contents, this alert indicates a command injection attempt against a web application endpoint.</p>
<h3 id="4-ip-reputation-check">4. Ip reputation check</h3>
<p>The IP appears to be coming from china with domain register chinatelecom.com.cn attackers are using a 3rd party service to look ligit
<img src="https://i.ibb.co/tMSBSshj/image1.png" alt=""></p>
<p>Searching on virus total only 2 vendors marked it as malware and suspicious not much. Checking the community tab looks like this ip ahas been caring ssh bruteforce attack since 09-Jan-2022  to 6-12-2022
<img src="https://i.ibb.co/DDsQ5VM8/image12.png" alt="">
<img src="https://i.ibb.co/RGCWqXcL/image13.png" alt=""></p>
<h3 id="5-initial-investigation-and-traffic-analysis">5. Initial Investigation and Traffic Analysis</h3>
<ul>
<li>The traffic originated from an external public IP address and was not associated with internal systems.</li>
<li>No legitimate business activity or scheduled testing was identified at the time of the alert.</li>
<li>The User-Agent string is outdated and commonly used by automated attack tools.</li>
<li>The HTTP response status was 200 OK, and the response size was larger than usual, which may indicate successful command execution.</li>
</ul>
<p><img src="https://i.ibb.co/WTZssBw/image14.png" alt="">
<img src="https://i.ibb.co/6c5nxjSs/image15.png" alt="">
These indicators strongly reduce the likelihood of a false positive.</p>
<h3 id="6-email-and-user-activity-review">6. Email and User Activity Review</h3>
<ul>
<li>No emails, maintenance tasks, or internal testing activities were recorded during the time of the alert.</li>
<li>No authorized user activity matched the request.</li>
</ul>
<p>This confirms the traffic was not internally generated.</p>
<h3 id="7-system-log-analysis">7. System Log Analysis</h3>
<ul>
<li>System logs indicate evidence of unauthorized command execution.</li>
<li>The attack appears to have succeeded within a Docker container environment.</li>
<li>The attacker likely gained root privileges inside the container, but not on the host system.
![[Pasted image 20260113152047.png]]
![[Pasted image 20260113152120.png]]
This points to a container-level compromise rather than a full system breach.</li>
</ul>
<h3 id="8-impact-assessment">8. Impact Assessment</h3>
<ul>
<li>Scope of access: Limited to Docker container</li>
<li>Host system compromise: No</li>
<li>Potential data exposure: Limited to container</li>
<li>Persistence risk: Low after container reset<br>
Although contained, this is still considered a <strong>successful exploitation attempt</strong>.</li>
</ul>
<h3 id="9-recommended-actions">9. Recommended Actions</h3>
<ol>
<li>Immediately isolate and reset the affected container</li>
<li>Patch the vulnerable web application</li>
<li>Improve input validation and sanitization</li>
<li>Implement WAF rules to block command injection patterns</li>
<li>Monitor for additional activity from the source IP</li>
<li>Block the source IP if no legitimate business need exists</li>
</ol>
<h3 id="final-verdict">Final Verdict</h3>
<p>True Positive – Confirmed Web Attack</p>
<p>The alert represents a successful command injection attack that resulted in root-level access within a Docker container. Although the host system was not compromised, immediate remediation and hardening are required.</p>

                </div>
            </article>

            <hr />

            <div class="post-info">
                
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/letsdefend/">letsdefend</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/soc/">soc</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/blue/">blue</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/web-attack/">web-attack</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/command-injection/">command-injection</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/http/">http</a></span>
        
    </p>

                
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="http://localhost:1313/categories/soc-writeups/">SOC Writeups</a></span>
        <span class="tag"><a href="http://localhost:1313/categories/web-security/">Web Security</a></span>
        
    </p>

            </div>
        </main>
    </div>


            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            <span><a href="http://localhost:1313/"></a></span>
            <span></span>
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by Hugo</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.19d7885e5a4b0e5e2cd7238fc80b8b19888099cb78c032aedeb0b3b0010b8bb3dfb34849cf40a9e83f55f266aa32354528c10a24f2a42e6e8e21e813a26d9647.js" integrity="sha512-GdeIXlpLDl4s1yOPyAuLGYiAmct4wDKu3rCzsAELi7Pfs0hJz0Cp6D9V8maqMjVFKMEKJPKkLm6OIegTom2WRw=="></script>




    </body>
</html>
